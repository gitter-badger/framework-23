<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>Modules - Onion - Framework</title>
  

  <link rel="shortcut icon" href="../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Modules";
    var mkdocs_page_input_path = "modules.md";
    var mkdocs_page_url = "/modules/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Onion - Framework</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">Intro</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../setup/">Tutorial</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Advanced</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../routing/">Routing</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Modules</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#introduction">Introduction</a></li>
                
            
                <li class="toctree-l3"><a href="#setup">Setup</a></li>
                
            
                <li class="toctree-l3"><a href="#configuration">Configuration</a></li>
                
            
            </ul>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Onion - Framework</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Advanced &raquo;</li>
        
      
    
    <li>Modules</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="introduction">Introduction</h2>
<p>Modules are not a new concept in the development world, nor they re new 
to the PHP frameworks/applications. The implementation used here is not
too different from what has already been implemented in other frameworks
but the intent is clear and is aimed at enforcing the separation of 
applications in logical parts, rather than having module provide 
helper functionality (although they can also be used in that way, but 
might fee less intuitive)</p>
<h2 id="setup">Setup</h2>
<p>A module should have it's logic as self-contained as possible, except 
for configurations, since that will change from application to 
application.</p>
<p>The only requirement in order to ensure consistency (as of now it is not
enforced) is for the module to serve as a factory that MUST return
instance of <code>Application</code>, since application is a middleware it does not
introduce a very specific behaviour, except maybe for having a separate
middleware delegate defined and a separate router for the module itself.</p>
<p>Internally the <code>ModuleDelegateFactory</code> is building a router with every
instance <code>Application</code> assigned it's own prefix inside a <code>module</code> key.</p>
<h2 id="configuration">Configuration</h2>
<p>The minimal configuration to the container is:</p>
<pre><code>return [
    // .. other configuration
    'modules' =&gt; [
        '/api' =&gt; MyApp\API\Module::class
    ]
]
</code></pre>

<p>An example module class:</p>
<pre><code>namespace MyApp\API;

use Interop\Container\ContainerInterface;
use Onion\Framework\Application\Application;
use Onion\Framework\Application\Interfaces\ModuleInterface;

class Module implements ModuleInterface
{
    private function getConfigurations(): array
    {
        return [
            'routes' =&gt; [
                [
                    'pattern' =&gt; '/api/users',
                    'middleware' =&gt; [
                        UsersApiController::class
                    ]
                ]
            ]
        ];
    }

    public function build(ContainerInterface $container): Application
    {
        // Logic of creating a router ONLY with module-specific routes
        return new Application
            $router,
            $container-&gt;get(EmitterInterface::class)
        );
    }
}
</code></pre>

<p>It is recommended for a module class to fetch the <code>EmitterInterface</code> 
from the main container, instead of defining it's own since it will 
avoid issues with custom emitter implementations if applicable. Also
note that the route must have the prefix defined by default in order to
avoid this duplication (if that is your thing, but do keep in mind that
the intent behind this kind of modules is that a module can and should 
be able to function as it's own application and not only as a module of
another). Once the initial testing has been performed a CLI application
will be developed allowing for the generation of module classes from 
existing applications, which will empower use-cases such as minimal blog
to be embedded inside another application at a prefix; as well as 
install/uninstall steps, but that is TBD as of now so don't rely 
completely on that, but do keep in mind that the reasoning behind the
modules is here to stay.</p>
<p><strong><em> This is only intended to be a WEB framework and not a multi-purpose 
one that can aid building of CLI apps</em></strong></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../routing/" class="btn btn-neutral" title="Routing"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../routing/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>

</body>
</html>
